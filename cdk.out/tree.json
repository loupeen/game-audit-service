{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.212.0"},"children":{"GameAuditService-test":{"id":"GameAuditService-test","path":"GameAuditService-test","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.212.0"},"children":{"AuditEventsTable":{"id":"AuditEventsTable","path":"GameAuditService-test/AuditEventsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AuditEventsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"eventId","attributeType":"S"},{"attributeName":"timestamp","attributeType":"S"},{"attributeName":"serviceName","attributeType":"S"},{"attributeName":"eventType","attributeType":"S"},{"attributeName":"principalId","attributeType":"S"},{"attributeName":"riskLevel","attributeType":"S"}],"globalSecondaryIndexes":[{"indexName":"ServiceEventTypeIndex","keySchema":[{"attributeName":"serviceName","keyType":"HASH"},{"attributeName":"eventType","keyType":"RANGE"}],"projection":{"projectionType":"ALL"},"provisionedThroughput":{"readCapacityUnits":5,"writeCapacityUnits":5}},{"indexName":"PrincipalTimeIndex","keySchema":[{"attributeName":"principalId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"},"provisionedThroughput":{"readCapacityUnits":5,"writeCapacityUnits":5}},{"indexName":"RiskLevelTimeIndex","keySchema":[{"attributeName":"riskLevel","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"projection":{"projectionType":"ALL"},"provisionedThroughput":{"readCapacityUnits":5,"writeCapacityUnits":5}}],"keySchema":[{"attributeName":"eventId","keyType":"HASH"},{"attributeName":"timestamp","keyType":"RANGE"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":false},"provisionedThroughput":{"readCapacityUnits":5,"writeCapacityUnits":5},"sseSpecification":{"sseEnabled":true},"tableName":"loupeen-audit-events-test"}}},"ScalingRole":{"id":"ScalingRole","path":"GameAuditService-test/AuditEventsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}}}},"EventIngestionFunction":{"id":"EventIngestionFunction","path":"GameAuditService-test/EventIngestionFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.212.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"GameAuditService-test/EventIngestionFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.212.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"GameAuditService-test/EventIngestionFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}},"Resource":{"id":"Resource","path":"GameAuditService-test/EventIngestionFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"GameAuditService-test/EventIngestionFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/EventIngestionFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"},{"Action":["dynamodb:BatchWriteItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:PutItem","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AuditEventsTable0723963E","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AuditEventsTable0723963E","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"EventIngestionFunctionServiceRoleDefaultPolicy447A299B","roles":[{"Ref":"EventIngestionFunctionServiceRole63D06A8E"}]}}}}}}},"Code":{"id":"Code","path":"GameAuditService-test/EventIngestionFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.212.0"},"children":{"Stage":{"id":"Stage","path":"GameAuditService-test/EventIngestionFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.212.0"}},"AssetBucket":{"id":"AssetBucket","path":"GameAuditService-test/EventIngestionFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.212.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"GameAuditService-test/EventIngestionFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-728427470046-eu-north-1","s3Key":"8c1db2e5b37f0acff3872bc1d1a683817637536f13df1548599dfa61b7edac4b.zip"},"environment":{"variables":{"AUDIT_TABLE_NAME":{"Ref":"AuditEventsTable0723963E"},"ENVIRONMENT":"test","LOG_LEVEL":"DEBUG"}},"functionName":"game-audit-ingestion-test","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["EventIngestionFunctionServiceRole63D06A8E","Arn"]},"runtime":"nodejs20.x","timeout":120,"tracingConfig":{"mode":"Active"}}}},"LogRetention":{"id":"LogRetention","path":"GameAuditService-test/EventIngestionFunction/LogRetention","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogRetention","version":"2.212.0"},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/EventIngestionFunction/LogRetention/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.212.0"}}}},"LogGroup":{"id":"LogGroup","path":"GameAuditService-test/EventIngestionFunction/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}}}},"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a":{"id":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Code":{"id":"Code","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.212.0"},"children":{"Stage":{"id":"Stage","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.212.0"}},"AssetBucket":{"id":"AssetBucket","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.212.0","metadata":[]}}}},"ServiceRole":{"id":"ServiceRole","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.212.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}},"Resource":{"id":"Resource","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:DeleteRetentionPolicy","logs:PutRetentionPolicy"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB","roles":[{"Ref":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"}]}}}}}}},"Resource":{"id":"Resource","path":"GameAuditService-test/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.212.0"}}}},"QueryFunction":{"id":"QueryFunction","path":"GameAuditService-test/QueryFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.212.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"GameAuditService-test/QueryFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.212.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"GameAuditService-test/QueryFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}},"Resource":{"id":"Resource","path":"GameAuditService-test/QueryFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"GameAuditService-test/QueryFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/QueryFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AuditEventsTable0723963E","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AuditEventsTable0723963E","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"QueryFunctionServiceRoleDefaultPolicyF63D0CC9","roles":[{"Ref":"QueryFunctionServiceRoleF5EB059D"}]}}}}}}},"Code":{"id":"Code","path":"GameAuditService-test/QueryFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.212.0"},"children":{"Stage":{"id":"Stage","path":"GameAuditService-test/QueryFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.212.0"}},"AssetBucket":{"id":"AssetBucket","path":"GameAuditService-test/QueryFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.212.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"GameAuditService-test/QueryFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-728427470046-eu-north-1","s3Key":"3472665750cd9dfa7ac659a8dcab1c830e350cc0bf21fef21f4912ddf40c1a92.zip"},"environment":{"variables":{"AUDIT_TABLE_NAME":{"Ref":"AuditEventsTable0723963E"},"ENVIRONMENT":"test","LOG_LEVEL":"DEBUG"}},"functionName":"game-audit-query-test","handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["QueryFunctionServiceRoleF5EB059D","Arn"]},"runtime":"nodejs20.x","timeout":30,"tracingConfig":{"mode":"Active"}}}},"LogRetention":{"id":"LogRetention","path":"GameAuditService-test/QueryFunction/LogRetention","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogRetention","version":"2.212.0"},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/QueryFunction/LogRetention/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.212.0"}}}},"LogGroup":{"id":"LogGroup","path":"GameAuditService-test/QueryFunction/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}}}},"AuthEventsRule":{"id":"AuthEventsRule","path":"GameAuditService-test/AuthEventsRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AuthEventsRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Capture authentication and authorization events for audit trail","eventPattern":{"source":["loupeen.auth","loupeen.authz"],"detail-type":["Authentication Event","Authorization Event","Token Event","Permission Change"]},"name":"loupeen-auth-events-test","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["EventIngestionFunction72EAC0E5","Arn"]},"retryPolicy":{"maximumRetryAttempts":3}}]}}},"AllowEventRuleGameAuditServicetestEventIngestionFunction0F7EA450":{"id":"AllowEventRuleGameAuditServicetestEventIngestionFunction0F7EA450","path":"GameAuditService-test/AuthEventsRule/AllowEventRuleGameAuditServicetestEventIngestionFunction0F7EA450","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EventIngestionFunction72EAC0E5","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["AuthEventsRule5163DC58","Arn"]}}}}}},"HighRiskEventsRule":{"id":"HighRiskEventsRule","path":"GameAuditService-test/HighRiskEventsRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/HighRiskEventsRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Capture high-risk security events for immediate audit attention","eventPattern":{"source":["loupeen.security"],"detail":{"riskLevel":["CRITICAL","HIGH"]}},"name":"loupeen-high-risk-events-test","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["EventIngestionFunction72EAC0E5","Arn"]},"retryPolicy":{"maximumRetryAttempts":5}}]}}},"AllowEventRuleGameAuditServicetestEventIngestionFunction0F7EA450":{"id":"AllowEventRuleGameAuditServicetestEventIngestionFunction0F7EA450","path":"GameAuditService-test/HighRiskEventsRule/AllowEventRuleGameAuditServicetestEventIngestionFunction0F7EA450","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EventIngestionFunction72EAC0E5","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["HighRiskEventsRule13D2AAAF","Arn"]}}}}}},"AuditPublisherRole":{"id":"AuditPublisherRole","path":"GameAuditService-test/AuditPublisherRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.212.0","metadata":[]},"children":{"ImportAuditPublisherRole":{"id":"ImportAuditPublisherRole","path":"GameAuditService-test/AuditPublisherRole/ImportAuditPublisherRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}},"Resource":{"id":"Resource","path":"GameAuditService-test/AuditPublisherRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"roleName":"loupeen-audit-publisher-test"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"GameAuditService-test/AuditPublisherRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AuditPublisherRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"events:PutEvents","Effect":"Allow","Resource":"arn:aws:events:eu-north-1:728427470046:event-bus/default"}],"Version":"2012-10-17"},"policyName":"AuditPublisherRoleDefaultPolicy6297FCE5","roles":[{"Ref":"AuditPublisherRole9F4BA1E8"}]}}}}}}},"AnomalyDetectionFunction":{"id":"AnomalyDetectionFunction","path":"GameAuditService-test/AnomalyDetectionFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.212.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"GameAuditService-test/AnomalyDetectionFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.212.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"GameAuditService-test/AnomalyDetectionFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}},"Resource":{"id":"Resource","path":"GameAuditService-test/AnomalyDetectionFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"GameAuditService-test/AnomalyDetectionFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AnomalyDetectionFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTelemetryRecords","xray:PutTraceSegments"],"Effect":"Allow","Resource":"*"},{"Action":["dynamodb:BatchGetItem","dynamodb:ConditionCheckItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:Scan"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AuditEventsTable0723963E","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AuditEventsTable0723963E","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"AnomalyDetectionFunctionServiceRoleDefaultPolicy7A77DD85","roles":[{"Ref":"AnomalyDetectionFunctionServiceRole5FE62A73"}]}}}}}}},"Code":{"id":"Code","path":"GameAuditService-test/AnomalyDetectionFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.212.0"},"children":{"Stage":{"id":"Stage","path":"GameAuditService-test/AnomalyDetectionFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.212.0"}},"AssetBucket":{"id":"AssetBucket","path":"GameAuditService-test/AnomalyDetectionFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.212.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"GameAuditService-test/AnomalyDetectionFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-728427470046-eu-north-1","s3Key":"167b39d1be47fbf31c627f833a9ec9173eba530f461f363b33197ea7039dcf72.zip"},"environment":{"variables":{"AUDIT_TABLE_NAME":{"Ref":"AuditEventsTable0723963E"},"ENVIRONMENT":"test","LOG_LEVEL":"DEBUG"}},"functionName":"game-audit-anomaly-test","handler":"index.handler","memorySize":512,"role":{"Fn::GetAtt":["AnomalyDetectionFunctionServiceRole5FE62A73","Arn"]},"runtime":"nodejs20.x","timeout":300,"tracingConfig":{"mode":"Active"}}}},"LogRetention":{"id":"LogRetention","path":"GameAuditService-test/AnomalyDetectionFunction/LogRetention","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogRetention","version":"2.212.0"},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AnomalyDetectionFunction/LogRetention/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.212.0"}}}},"LogGroup":{"id":"LogGroup","path":"GameAuditService-test/AnomalyDetectionFunction/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.212.0","metadata":[]}}}},"AnomalyDetectionSchedule":{"id":"AnomalyDetectionSchedule","path":"GameAuditService-test/AnomalyDetectionSchedule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AnomalyDetectionSchedule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Schedule anomaly detection analysis","name":"loupeen-anomaly-detection-test","scheduleExpression":"rate(1 hour)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["AnomalyDetectionFunction8A8B313C","Arn"]}}]}}},"AllowEventRuleGameAuditServicetestAnomalyDetectionFunctionFD000516":{"id":"AllowEventRuleGameAuditServicetestAnomalyDetectionFunctionFD000516","path":"GameAuditService-test/AnomalyDetectionSchedule/AllowEventRuleGameAuditServicetestAnomalyDetectionFunctionFD000516","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["AnomalyDetectionFunction8A8B313C","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["AnomalyDetectionSchedule4C2FEAA2","Arn"]}}}}}},"AuditDashboard":{"id":"AuditDashboard","path":"GameAuditService-test/AuditDashboard","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Dashboard","version":"2.212.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"GameAuditService-test/AuditDashboard/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnDashboard","version":"2.212.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Dashboard","aws:cdk:cloudformation:props":{"dashboardBody":{"Fn::Join":["",["{\"widgets\":[{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":0,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Event Ingestion Rate\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/Lambda\",\"Invocations\",\"FunctionName\",\"",{"Ref":"EventIngestionFunction72EAC0E5"},"\",{\"stat\":\"Sum\"}],[\"AWS/Lambda\",\"Errors\",\"FunctionName\",\"",{"Ref":"EventIngestionFunction72EAC0E5"},"\",{\"stat\":\"Sum\",\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":6,\"height\":6,\"x\":6,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Query Function Performance\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/Lambda\",\"Duration\",\"FunctionName\",\"",{"Ref":"QueryFunctionBDF4DE5B"},"\"],[\"AWS/Lambda\",\"Errors\",\"FunctionName\",\"",{"Ref":"QueryFunctionBDF4DE5B"},"\",{\"stat\":\"Sum\",\"yAxis\":\"right\"}]],\"yAxis\":{}}}]}"]]},"dashboardName":"loupeen-audit-service-test"}}}}},"AuditTableName":{"id":"AuditTableName","path":"GameAuditService-test/AuditTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.212.0"}},"EventIngestionFunctionArn":{"id":"EventIngestionFunctionArn","path":"GameAuditService-test/EventIngestionFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.212.0"}},"QueryFunctionArn":{"id":"QueryFunctionArn","path":"GameAuditService-test/QueryFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.212.0"}},"AuditPublisherRoleArn":{"id":"AuditPublisherRoleArn","path":"GameAuditService-test/AuditPublisherRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.212.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"GameAuditService-test/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"GameAuditService-test/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.212.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"GameAuditService-test/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.212.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"GameAuditService-test/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.212.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}